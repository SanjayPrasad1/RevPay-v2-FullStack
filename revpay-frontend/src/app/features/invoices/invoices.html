 <div class="layout">
      <nav class="sidebar">
        <div class="brand">RevPay</div>
        <a class="nav-link" routerLink="/dashboard"><span class="material-icons">dashboard</span> Dashboard</a>
        <a class="nav-link" routerLink="/transactions"><span class="material-icons">swap_horiz</span> Transactions</a>
        <a class="nav-link" routerLink="/money-requests"><span class="material-icons">request_page</span> Money Requests</a>
        <a class="nav-link" routerLink="/payment-methods"><span class="material-icons">credit_card</span> Payment Methods</a>
        <a class="nav-link" routerLink="/notifications"><span class="material-icons">notifications</span> Notifications</a>
        <div class="nav-section">Business</div>
        <a class="nav-link active" routerLink="/invoices"><span class="material-icons">receipt</span> Invoices</a>
        <a class="nav-link" routerLink="/loans"><span class="material-icons">account_balance</span> Loans</a>
        <div class="sidebar-footer">
          <a class="nav-link" routerLink="/profile"><span class="material-icons">person</span> Profile</a>
          <button class="nav-link btn-reset" (click)="logout()"><span class="material-icons">logout</span> Logout</button>
        </div>
      </nav>
      <main class="main-content">
        <div class="page-container">
          <mat-tab-group>
            <mat-tab label="All Invoices">
              <div class="mt-16">
                <table mat-table [dataSource]="invoices" class="full-width">
                  <ng-container matColumnDef="number"><th mat-header-cell *matHeaderCellDef>Number</th><td mat-cell *matCellDef="let i">{{ i.invoiceNumber }}</td></ng-container>
                  <ng-container matColumnDef="customer"><th mat-header-cell *matHeaderCellDef>Customer</th><td mat-cell *matCellDef="let i">{{ i.customerName }}</td></ng-container>
                  <ng-container matColumnDef="amount"><th mat-header-cell *matHeaderCellDef>Amount</th><td mat-cell *matCellDef="let i">{{ i.totalAmount | currency }}</td></ng-container>
                  <ng-container matColumnDef="status"><th mat-header-cell *matHeaderCellDef>Status</th><td mat-cell *matCellDef="let i"><span class="status-badge {{ i.status }}">{{ i.status }}</span></td></ng-container>
                  <ng-container matColumnDef="due"><th mat-header-cell *matHeaderCellDef>Due Date</th><td mat-cell *matCellDef="let i">{{ i.dueDate | date }}</td></ng-container>
                  <ng-container matColumnDef="actions">
                    <th mat-header-cell *matHeaderCellDef>Actions</th>
                    <td mat-cell *matCellDef="let i">
                      <button mat-button (click)="sendInvoice(i.id)" *ngIf="i.status === 'DRAFT'">Send</button>
                      <button mat-button color="primary" (click)="markPaid(i.id)" *ngIf="i.status === 'SENT' || i.status === 'OVERDUE'">Mark Paid</button>
                    </td>
                  </ng-container>
                  <tr mat-header-row *matHeaderRowDef="cols"></tr>
                  <tr mat-row *matRowDef="let r; columns: cols;"></tr>
                </table>
                <p *ngIf="!invoices.length" class="no-data">No invoices yet</p>
              </div>
            </mat-tab>
            <!-- <mat-tab label="My Invoices">
                <div class="mt-16">
                  <div *ngIf="accountType === 'BUSINESS'">
                    <table mat-table [dataSource]="invoices" class="full-width">
                      <ng-container matColumnDef="number">
                        <th mat-header-cell *matHeaderCellDef>Invoice #</th>
                        <td mat-cell *matCellDef="let inv">{{inv.invoiceNumber}}</td>
                      </ng-container>
                      <ng-container matColumnDef="customer">
                        <th mat-header-cell *matHeaderCellDef>Customer</th>
                        <td mat-cell *matCellDef="let inv">{{inv.customerName}}</td>
                      </ng-container>
                      <ng-container matColumnDef="amount">
                        <th mat-header-cell *matHeaderCellDef>Amount</th>
                        <td mat-cell *matCellDef="let inv">{{inv.totalAmount | currency}}</td>
                      </ng-container>
                      <ng-container matColumnDef="status">
                        <th mat-header-cell *matHeaderCellDef>Status</th>
                        <td mat-cell *matCellDef="let inv">
                          <span class="status-badge" [ngClass]="inv.status.toLowerCase()">{{inv.status}}</span>
                        </td>
                      </ng-container>
                      <ng-container matColumnDef="due">
                        <th mat-header-cell *matHeaderCellDef>Due Date</th>
                        <td mat-cell *matCellDef="let inv">{{inv.dueDate | date}}</td>
                      </ng-container>
                      <ng-container matColumnDef="actions">
                        <th mat-header-cell *matHeaderCellDef>Actions</th>
                        <td mat-cell *matCellDef="let inv">
                          <button mat-icon-button color="primary" *ngIf="inv.status === 'DRAFT'" (click)="sendInvoice(inv.id)" title="Send">
                            <span class="material-icons">send</span>
                          </button>
                          <button mat-icon-button color="accent" *ngIf="inv.status === 'SENT'" (click)="markPaid(inv.id)" title="Mark as Paid">
                            <span class="material-icons">check_circle</span>
                          </button>
                        </td>
                      </ng-container>

                      <tr mat-header-row *matHeaderRowDef="cols"></tr>
                      <tr mat-row *matRowDef="let row; columns: cols;"></tr>
                    </table>
                  </div>

                  <div *ngIf="accountType === 'PERSONAL'">
                    <table mat-table [dataSource]="receivedInvoices" class="full-width">
                      <ng-container matColumnDef="number">
                        <th mat-header-cell *matHeaderCellDef>Invoice #</th>
                        <td mat-cell *matCellDef="let inv">{{inv.invoiceNumber}}</td>
                      </ng-container>
                      <ng-container matColumnDef="business">
                        <th mat-header-cell *matHeaderCellDef>From Business</th>
                        <td mat-cell *matCellDef="let inv">{{inv.businessName}}</td>
                      </ng-container>
                      <ng-container matColumnDef="amount">
                        <th mat-header-cell *matHeaderCellDef>Amount</th>
                        <td mat-cell *matCellDef="let inv">{{inv.totalAmount | currency}}</td>
                      </ng-container>
                      <ng-container matColumnDef="status">
                        <th mat-header-cell *matHeaderCellDef>Status</th>
                        <td mat-cell *matCellDef="let inv">
                          <span class="status-badge" [ngClass]="inv.status.toLowerCase()">{{inv.status}}</span>
                        </td>
                      </ng-container>
                      <ng-container matColumnDef="actions">
                        <th mat-header-cell *matHeaderCellDef>Actions</th>
                        <td mat-cell *matCellDef="let inv">
                          <button mat-raised-button color="primary" *ngIf="inv.status === 'SENT'" (click)="pay(inv)">
                            Pay Now
                          </button>
                        </td>
                      </ng-container>

                      <tr mat-header-row *matHeaderRowDef="['number', 'business', 'amount', 'status', 'actions']"></tr>
                      <tr mat-row *matRowDef="let row; columns: ['number', 'business', 'amount', 'status', 'actions'];"></tr>
                    </table>
                    <div *ngIf="receivedInvoices.length === 0" class="empty-state">No invoices received.</div>
                  </div>
                </div>
              </mat-tab> -->
            <mat-tab label="Create Invoice">
              <mat-card class="mt-16">
                <mat-card-content>
                  <form [formGroup]="invoiceForm" (ngSubmit)="createInvoice()">
                    <div class="form-grid">
                      <mat-form-field><mat-label>Customer Name</mat-label><input matInput formControlName="customerName"></mat-form-field>
                      <mat-form-field><mat-label>Customer Email</mat-label><input matInput formControlName="customerEmail"></mat-form-field>
                      <mat-form-field><mat-label>Customer Address</mat-label><input matInput formControlName="customerAddress"></mat-form-field>
                      <mat-form-field><mat-label>Payment Terms</mat-label><input matInput formControlName="paymentTerms" placeholder="e.g. Net 30"></mat-form-field>
                      <mat-form-field><mat-label>Due Date</mat-label><input matInput type="date" formControlName="dueDate"></mat-form-field>
                      <mat-form-field><mat-label>Notes</mat-label><input matInput formControlName="notes"></mat-form-field>
                    </div>

                    <h3>Line Items</h3>
                    <div formArrayName="lineItems">
                      <div *ngFor="let item of lineItems.controls; let i=index" [formGroupName]="i" class="line-item">
                        <mat-form-field><mat-label>Description</mat-label><input matInput formControlName="description"></mat-form-field>
                        <mat-form-field><mat-label>Qty</mat-label><input matInput type="number" formControlName="quantity"></mat-form-field>
                        <mat-form-field><mat-label>Unit Price</mat-label><input matInput type="number" formControlName="unitPrice"></mat-form-field>
                        <mat-form-field><mat-label>Tax %</mat-label><input matInput type="number" formControlName="taxRate"></mat-form-field>
                        <button mat-icon-button color="warn" type="button" (click)="removeLineItem(i)"><span class="material-icons">delete</span></button>
                      </div>
                    </div>
                    <button mat-stroked-button type="button" (click)="addLineItem()" class="mb-16">+ Add Line Item</button>
                    <br>
                    <button mat-raised-button color="primary" type="submit" [disabled]="invoiceForm.invalid">Create Invoice</button>
                  </form>
                </mat-card-content>
              </mat-card>
            </mat-tab>
          </mat-tab-group>
        </div>
      </main>
    </div>